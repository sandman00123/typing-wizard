<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Typing Wizard – Mobile</title>
  <style>
    html,body {margin:0;height:100%;background:#0e0f19;}
    #game {position:fixed; inset:0; border:0; width:100%; height:100%;}
    #overlay {position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
      background:rgba(0,0,0,.5); color:#fff; font:600 18px system-ui; cursor:pointer;}
    /* off-screen input to trigger keyboard */
    #kb { position:fixed; left:-10000px; top:-10000px; opacity:0; }
  </style>
</head>
<body>
  <iframe id="game" src="game.html" allow="gamepad *"></iframe>
  <input id="kb" type="text" autocapitalize="none" autocomplete="off" autocorrect="off" spellcheck="false">
  <div id="overlay">Tap to start typing</div>

  <script>
    const frame = document.getElementById('game');
    const kb = document.getElementById('kb');
    const overlay = document.getElementById('overlay');

    // 1) user taps → focus hidden input → keyboard opens
    overlay.addEventListener('click', () => {
      overlay.style.display = 'none';
      kb.value = '';
      kb.focus({ preventScroll:true });
    });

    // 2) forward characters to the game iframe as keydown events
    kb.addEventListener('input', () => {
      const val = kb.value;
      if (!val) return;
      const ch = val.slice(-1);
      kb.value = ''; // clear so next char arrives cleanly
      // only a–z for this game
      if (!/^[a-zA-Z]$/.test(ch)) return;
      const evt = new KeyboardEvent('keydown', { key: ch, bubbles: true });
      frame.contentWindow.dispatchEvent(evt);
    });

    // Backspace support
    kb.addEventListener('keydown', (e) => {
      if (e.key === 'Backspace') {
        frame.contentWindow.dispatchEvent(new KeyboardEvent('keydown', { key:'Backspace', bubbles:true }));
        e.preventDefault();
      }
    });

    // Keep focus so keyboard stays open
    window.addEventListener('touchend', () => {
      if (document.activeElement !== kb) kb.focus({ preventScroll:true });
    });
  </script>
</body>
</html>

